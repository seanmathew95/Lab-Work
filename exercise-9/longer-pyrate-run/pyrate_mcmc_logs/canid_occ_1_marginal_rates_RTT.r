# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.186140347079, 0.186140347079,0.184832270126,0.184832270126,0.120820292389,0.067896098123,0.0422323055171,0.0451826947397,0.04630407511,0.0475565391217,0.0475565391217,0.0475565391217,0.0449431567602,0.0449431567602,0.0475565391217,0.0475565391217,0.0479019229743,0.0512569372085,0.0512569372085,0.0527790249717,0.0537077399729,0.0736306362735,0.0913719670443,0.0913719670443,0.0913719670443,0.0913719670443,0.0913719670443,0.0913719670443,0.0913719670443,0.0847359488704,0.0913922542489,0.128241908431,0.128241908431,0.13012235202,0.124322381423,0.136097388655,0.124322381423,0.124322381423,0.125795099483,0.109794591228,0.106894245067,0.106894245067,0.103028181511,0.0903422921655,0.0851218340541,0.0757653260219,0.0618990332473,0.0653829629842,0.0598773971269,0.0575361421873,0.0568895648167,0.0541433951279,0.0512042672863,0.0512042672863)
L_hpd_M95=c(0.38761228124, 0.38761228124,0.384757684824,0.388414690101,0.355634847482,0.335734472037,0.260359001108,0.1289762961,0.12674919947,0.12674919947,0.126591466701,0.126413574518,0.123069975263,0.123363593554,0.126413574518,0.127102586293,0.131752902527,0.145653066427,0.148343797454,0.161833141453,0.189382335644,0.218332429199,0.21857857703,0.218332429199,0.218332429199,0.218332429199,0.218445954883,0.218532598416,0.221245689906,0.240451444747,0.340986180638,0.395108838212,0.397706724686,0.404135175153,0.405664377343,0.41623376595,0.405664377343,0.407595492559,0.414856290753,0.404324797693,0.406919894313,0.414246555199,0.416825798116,0.408281050312,0.414163385209,0.427277112375,0.42917629614,0.44462497772,0.461680970355,0.469400688723,0.469400688723,0.469400688723,0.469400688723,0.469400688723)
M_hpd_m95=c(0.880275071771, 0.880275071771,0.087495867187,0.087495867187,0.0853859298297,0.0876130549666,0.0876130549666,0.0866550275661,0.0867268221016,0.08165833686,0.0830199789077,0.0809850696934,0.0816568810209,0.0816568810209,0.0824157907913,0.0830199789077,0.0830199789077,0.0830199789077,0.082471166376,0.0816568810209,0.0816568810209,0.0795903150512,0.0714702704943,0.0504790458849,0.0453064207238,0.041183699475,0.0388914837637,0.0395992501209,0.0395992501209,0.0398180030475,0.0395992501209,0.0388706055317,0.0385545973048,0.0385545973048,0.0385956052899,0.0382302748104,0.0378131674323,0.0376080668523,0.0368409400943,0.0368409400943,0.0360829828663,0.0360829828663,0.0345111710761,0.0350198565917,0.0350198565917,0.0345111710761,0.0347709056418,0.0347709056418,0.0347709056418,0.0347709056418,0.0347709056418,0.0347709056418,0.0347709056418,0.0347709056418)
M_hpd_M95=c(1.53756681565, 1.53756681565,0.168460200871,0.168460200871,0.165700160708,0.16509181756,0.163086970877,0.160008130138,0.159915355571,0.153371987568,0.146030118489,0.141040057684,0.139526726898,0.139526726898,0.13758134611,0.137975859727,0.13758134611,0.13758134611,0.137324837307,0.137109576818,0.13758134611,0.13758134611,0.140482859887,0.132787038668,0.128415256806,0.12255221681,0.117986859163,0.117986859163,0.117799480289,0.117799480289,0.117758643734,0.117694716807,0.117641446259,0.117799480289,0.117986859163,0.117986859163,0.117641446259,0.117986859163,0.117641446259,0.117758643734,0.117758643734,0.117986859163,0.117230560104,0.117799480289,0.117799480289,0.117230560104,0.117641446259,0.117641446259,0.117641446259,0.117641446259,0.117641446259,0.117641446259,0.117641446259,0.117641446259)
R_hpd_m95=c(-1.26939666917, -1.26939666917,0.0372261768745,0.0372261768745,0.00187647344257,-0.0537511070329,-0.103233105055,-0.100909667536,-0.0927758856609,-0.0910319167086,-0.080482327691,-0.0804574407982,-0.0780505777457,-0.07777176516,-0.07777176516,-0.0775236167037,-0.0729295619092,-0.0707269839732,-0.0719439421146,-0.0697803433341,-0.0668229002699,-0.0404240991601,-0.0169942845858,-0.0141252895388,-0.00805188219959,0.00348159392638,0.00317016927102,0.00737889103557,0.00616011310331,0.00317016927102,0.0136802118627,0.0357307082674,0.0365199137852,0.0371638454821,0.0471437826464,0.0357307082674,0.0365199137852,0.0335559014293,0.036380848683,0.0231614408236,0.0231614408236,0.0231614408236,0.000429269749402,0.00911859528009,0.000632084996899,-0.00737629628834,-0.018003166751,-0.0260423297523,-0.0201638337021,-0.0344518656051,-0.0248842969871,-0.0248842969871,-0.0266186059936,-0.0266186059936)
R_hpd_M95=c(-0.588654000209, -0.588654000209,0.259622403121,0.262367379896,0.256057896326,0.231233278825,0.157364561822,0.0202013316867,0.0216154337442,0.0202013316867,0.0273093445393,0.0231736336728,0.0216154337442,0.0216154337442,0.0202013316867,0.0215011961245,0.0298592913599,0.0421902397017,0.0451668707206,0.0604924767745,0.0885719783725,0.116996539208,0.131336245308,0.135294302587,0.147082937445,0.161787951775,0.158942929894,0.163063966257,0.163063966257,0.188462537468,0.283056754582,0.325817395708,0.325817395708,0.334156450272,0.349762505847,0.334156450272,0.334156450272,0.334156450272,0.341751268738,0.333746087962,0.34360877933,0.353628383296,0.336555690924,0.34890459234,0.34890459234,0.361506692725,0.368772937172,0.37109908789,0.401147610447,0.401927978409,0.413338917071,0.415454068691,0.415454068691,0.415454068691)
L_mean=c(0.267006320776, 0.267006320776,0.2671742198,0.267303982064,0.262229587889,0.244704816144,0.0999917702892,0.0820659386022,0.0810017301211,0.0805194344204,0.0804485536461,0.080435323642,0.080458775073,0.0805211665222,0.0807087633551,0.0809737949362,0.0822916932996,0.086271120925,0.0878501230516,0.0935607728988,0.113735915908,0.153715111871,0.161006566111,0.161777068185,0.161829876154,0.161865228274,0.161873269727,0.162100589907,0.163148187446,0.169824466008,0.202012128918,0.241205288608,0.251156174396,0.257983779882,0.26247016886,0.262338867185,0.262120052349,0.261230185856,0.25927201305,0.256042134731,0.253828625675,0.250960871077,0.247800429402,0.246004677021,0.24730527986,0.251358357145,0.248839536443,0.246759496066,0.245402120335,0.245946481116,0.24663986708,0.246307629294,0.24653259294,0.24653259294)
M_mean=c(1.16808980787, 1.16808980787,0.121442925382,0.121439412828,0.121287235881,0.11981803835,0.118754494711,0.117593237368,0.116939262856,0.115578057636,0.113281914721,0.11220564853,0.111545458798,0.111465997601,0.110404998134,0.109902526086,0.109593156548,0.109569540571,0.109543157272,0.109833667988,0.109792262862,0.109309316202,0.106979922916,0.0980536002276,0.0910757037482,0.0846332064582,0.0814156726219,0.0800884607856,0.0791131754075,0.0786760204198,0.0785149987798,0.0784417883681,0.0780719090632,0.0785143831571,0.0786337797906,0.0785116487568,0.07844473243,0.0782177071557,0.0781582352738,0.0780898733371,0.0778787967763,0.077754654357,0.0776666104904,0.0777024468645,0.0777024468645,0.0777048794939,0.0777833605112,0.0777833605112,0.0777833605112,0.0777833605112,0.0777833605112,0.0777833605112,0.0777833605112,0.0777833605112)
R_mean=c(-0.901083487099, -0.901083487099,0.145731294419,0.145864569236,0.140942352009,0.124886777794,-0.0187627244221,-0.0355272987658,-0.035937532735,-0.0350586232152,-0.0328333610747,-0.031770324888,-0.0310866837254,-0.030944831079,-0.0296962347789,-0.0289287311498,-0.0273014632481,-0.0232984196458,-0.0216930342204,-0.0162728950897,0.00394365304635,0.0444057956697,0.0540266431955,0.063723467957,0.0707541724054,0.0772320218157,0.0804575971056,0.0820121291214,0.0840350120383,0.0911484455877,0.123497130138,0.16276350024,0.173084265333,0.179469396724,0.183836389069,0.183827218428,0.183675319919,0.183012478701,0.181113777776,0.177952261394,0.175949828898,0.17320621672,0.170133818912,0.168302230157,0.169602832996,0.173653477651,0.171056175932,0.168976135555,0.167618759823,0.168163120605,0.168856506568,0.168524268783,0.168749232429,0.168749232429)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.516340757596), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.69132349721), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.39633633609, 0.45699947556), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()