# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.199909496056, 0.199909496056,0.199909496056,0.199909496056,0.199909496056,0.0428249575168,0.0428249575168,0.0428249575168,0.0428249575168,0.0428249575168,0.0515735270895,0.0515735270895,0.050429651842,0.050429651842,0.0435139884533,0.0508364529725,0.050429651842,0.0508364529725,0.0641438374176,0.0659262835481,0.0671574344387,0.079398625986,0.0957549839496,0.101418962489,0.0993872218288,0.101418962489,0.101418962489,0.110928609142,0.108568193737,0.0993872218288,0.117899504783,0.13407652047,0.13438249122,0.128462463071,0.159400352873,0.159400352873,0.159400352873,0.159400352873,0.159400352873,0.159400352873,0.158108329274,0.128462463071,0.128462463071,0.158108329274,0.158108329274,0.134382014618,0.134382014618,0.134382014618,0.134382014618,0.134382014618)
L_hpd_M95=c(0.385869002802, 0.385869002802,0.385869002802,0.390819447179,0.40439798165,0.323891866263,0.143230980815,0.140759882306,0.13407652047,0.13407652047,0.14404949679,0.14404949679,0.143395560695,0.143395560695,0.135662590747,0.146286448114,0.169041803128,0.183328951258,0.188316008929,0.1964965952,0.204220298811,0.209485884487,0.220781466383,0.220781466383,0.220781466383,0.220781466383,0.220781466383,0.233627766377,0.25034393068,0.278924446297,0.341161399272,0.382355814892,0.386305929855,0.398267111934,0.430877087375,0.430877087375,0.436257840899,0.436257840899,0.435421127564,0.436257840899,0.436257840899,0.414790978772,0.414790978772,0.449034733448,0.454780354688,0.449034733448,0.449034733448,0.449034733448,0.449034733448,0.449034733448)
M_hpd_m95=c(0.772141856516, 0.772141856516,0.088461902907,0.088461902907,0.088461902907,0.0864721679189,0.0917614740482,0.0917614740482,0.088461902907,0.0881021281811,0.0881021281811,0.0881021281811,0.0862835988468,0.0862835988468,0.0860153174676,0.0857332611123,0.0860153174676,0.0857332611123,0.0857332611123,0.0857332611123,0.0857332611123,0.0806509405783,0.0760610340873,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0702012343844,0.0685464448937,0.0584570150899,0.0556105869272,0.0584570150899,0.0584570150899,0.0584570150899,0.0584570150899,0.0584570150899)
M_hpd_M95=c(1.50106698224, 1.50106698224,0.200204848315,0.200204848315,0.200204848315,0.193501741413,0.191337640578,0.190812468368,0.169159846205,0.153225656915,0.15045640798,0.142827756963,0.14166024258,0.14166024258,0.136625909918,0.13461505578,0.135320477341,0.135320477341,0.135320477341,0.135320477341,0.135320477341,0.131136585776,0.132913757359,0.128149828997,0.128566720773,0.128149828997,0.128149828997,0.128149828997,0.128566720773,0.128566720773,0.128566720773,0.128566720773,0.128566720773,0.128566720773,0.128566720773,0.128566720773,0.128149828997,0.128149828997,0.128149828997,0.128149828997,0.128149828997,0.131136585776,0.131136585776,0.128566720773,0.131136585776,0.134763688645,0.134763688645,0.134763688645,0.134763688645,0.134763688645)
R_hpd_m95=c(-1.23107947948, -1.23107947948,0.0127329681617,0.0127329681617,0.0127329681617,-0.132701686949,-0.135101160219,-0.132701686949,-0.102134950392,-0.0868869209948,-0.0771453024661,-0.0771453024661,-0.0760432835885,-0.0737630612321,-0.0635312788312,-0.0760432835885,-0.0593138680387,-0.0582854309549,-0.0582854309549,-0.0477094601843,-0.0334343860585,-0.0312812642651,-0.0118841973433,-0.00298492312602,-0.00298492312602,0.00492146864221,0.00922517118935,0.0127397214796,0.00922517118935,0.00492146864221,0.0152244497717,0.0188021359959,0.0255268832293,0.0171799032041,0.025686934268,0.025686934268,0.0171799032041,0.0171799032041,0.025686934268,0.025686934268,0.025686934268,0.0188021359959,0.0188021359959,0.0462144476162,0.025686934268,0.025686934268,0.025686934268,0.025686934268,0.025686934268,0.025686934268)
R_hpd_M95=c(-0.467374458554, -0.467374458554,0.24170830793,0.245110197982,0.250338661842,0.225893967834,0.0340150587193,0.0340150587193,0.0267183930469,0.0267183930469,0.0267910782415,0.0267910782415,0.0267910782415,0.0307258955967,0.0340150587193,0.0307258955967,0.0624576656287,0.0841900704825,0.0841900704825,0.0993074551426,0.122739261815,0.109382651419,0.122330422175,0.132976669738,0.132976669738,0.140567378673,0.143724084809,0.143724084809,0.157742301895,0.186877994061,0.224595416891,0.267384856473,0.280204435489,0.280204435489,0.305121255123,0.305121255123,0.305121255123,0.305121255123,0.3164223501,0.321772747937,0.321772747937,0.321772747937,0.321772747937,0.367749585105,0.354037434892,0.368247214841,0.368247214841,0.368247214841,0.368247214841,0.368247214841)
L_mean=c(0.283278781931, 0.283278781931,0.283278781931,0.2823383569,0.281399347253,0.158739774507,0.0859698685468,0.0849436931432,0.0848344802729,0.0848344802729,0.0855766873772,0.0855766873772,0.0867761888474,0.0867640941327,0.0862225574825,0.0874729040932,0.100139119065,0.113729252748,0.1229854124,0.135407317307,0.147050674352,0.152912170528,0.160436975857,0.163383702939,0.164041804387,0.164929294757,0.164929294757,0.165839302478,0.169609252633,0.176789841844,0.2040406632,0.24238070093,0.252617565391,0.260351532542,0.274478483251,0.276880367518,0.277763746532,0.277882682674,0.274768567605,0.275697382481,0.275684462425,0.274774000633,0.273525575167,0.273128284697,0.27373266718,0.272207857299,0.270458474604,0.270220737154,0.270220737154,0.270220737154)
M_mean=c(1.10879839607, 1.10879839607,0.131495381936,0.131495381936,0.131495381936,0.13001756417,0.127063836106,0.124593020849,0.119054686217,0.11507390295,0.11429137152,0.113123735689,0.111786378366,0.10992033161,0.109266085415,0.108486764006,0.108008275136,0.107390443065,0.107390443065,0.107390443065,0.107420769259,0.106995780814,0.10526410063,0.102733244122,0.102213727761,0.102307387221,0.102241656013,0.101827344801,0.101672633296,0.101672633296,0.101672633296,0.101672633296,0.101672633296,0.101672633296,0.101672633296,0.101672633296,0.101527647588,0.101440870251,0.101440870251,0.101440870251,0.101440870251,0.101308439073,0.101261978293,0.103747483163,0.10468402011,0.104788314868,0.104788314868,0.104788314868,0.104788314868,0.104788314868)
R_mean=c(-0.825519614142, -0.825519614142,0.151783399995,0.150842974964,0.149903965318,0.0287222103361,-0.0410939675592,-0.0396493277056,-0.0342202059443,-0.0302394226772,-0.0287146841425,-0.027547048312,-0.0250101895189,-0.0231562374774,-0.0230435279329,-0.0210138599133,-0.00786915607102,0.006338809683,0.0155949693354,0.0280168742424,0.0396299050926,0.0459163897136,0.0551728752265,0.060650458817,0.0618280766263,0.0626219075363,0.0626876387441,0.0640119576767,0.0679366193364,0.0751172085478,0.102368029904,0.140708067634,0.150944932095,0.158678899246,0.172805849954,0.175207734222,0.176236098944,0.176441812423,0.173327697355,0.17425651223,0.174243592174,0.17346556156,0.172263596874,0.169380801534,0.16904864707,0.167419542431,0.165670159736,0.165432422286,0.165432422286,0.165432422286)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.500258390157), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.65117368046), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.35418742743, 0.405071936325), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()